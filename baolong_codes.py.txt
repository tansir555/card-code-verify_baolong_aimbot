import requests
import sys

# -------------------------- é…ç½®é¡¹ --------------------------
# æ›¿æ¢æˆä½  GitHub ä¸Šå¡å¯†æ–‡ä»¶çš„ Raw é“¾æ¥ï¼ˆå…¬å¼€ä»“åº“ï¼‰
# å…¬å¼€ä»“åº“ç¤ºä¾‹ï¼šhttps://raw.githubusercontent.com/ä½ çš„ç”¨æˆ·å/ä»“åº“å/åˆ†æ”¯å/æ–‡ä»¶è·¯å¾„/secret_key.txt
GITHUB_SECRET_URL = "https://raw.githubusercontent.com/tansir555/card-code-verify_baolong_aimbot/refs/heads/main/baolong_codes.json"
# å¦‚æœæ˜¯ç§æœ‰ä»“åº“ï¼Œéœ€è¦æ·»åŠ  GitHub Tokenï¼ˆåœ¨ GitHub è®¾ç½® -> Developer settings -> Personal access tokens åˆ›å»ºï¼‰
GITHUB_TOKEN = ""  # ç§æœ‰ä»“åº“å¿…å¡«ï¼Œå…¬å¼€ä»“åº“ç•™ç©ºå³å¯
# ------------------------------------------------------------

def get_github_secret():
    """ä» GitHub è¯»å–å¡å¯†"""
    headers = {}
    # ç§æœ‰ä»“åº“éœ€è¦æ·»åŠ  Token è®¤è¯
    if GITHUB_TOKEN:
        headers["Authorization"] = f"token {GITHUB_TOKEN}"
    
    try:
        # å‘é€è¯·æ±‚è¯»å–å¡å¯†æ–‡ä»¶
        response = requests.get(GITHUB_SECRET_URL, headers=headers, timeout=10)
        response.raise_for_status()  # æ•è· HTTP é”™è¯¯ï¼ˆæ¯”å¦‚ 404ã€403ï¼‰
        # å»é™¤é¦–å°¾ç©ºæ ¼/æ¢è¡Œç¬¦ï¼ˆé¿å…æ‰‹åŠ¨è¾“å…¥æ—¶çš„æ ¼å¼é—®é¢˜ï¼‰
        secret_key = response.text.strip()
        return secret_key
    except requests.exceptions.RequestException as e:
        print(f"âŒ è¯»å– GitHub å¡å¯†å¤±è´¥ï¼š{str(e)}")
        sys.exit(1)  # è¯»å–å¤±è´¥ç›´æ¥é€€å‡º

def verify_secret(input_key, real_key):
    """éªŒè¯å¡å¯†æ˜¯å¦æ­£ç¡®"""
    return input_key.strip() == real_key

def main():
    # 1. ä» GitHub è·å–æ­£ç¡®çš„å¡å¯†
    real_secret = get_github_secret()
    
    # 2. è®©ç”¨æˆ·è¾“å…¥å¡å¯†
    user_input = input("ğŸ”‘ è¯·è¾“å…¥å¡å¯†ï¼š").strip()
    
    # 3. éªŒè¯å¡å¯†
    if not verify_secret(user_input, real_secret):
        print("âŒ å¡å¯†é”™è¯¯ï¼Œè„šæœ¬é€€å‡ºï¼")
        sys.exit(1)
    
    # 4. å¡å¯†éªŒè¯é€šè¿‡ï¼Œæ‰§è¡Œæ ¸å¿ƒè„šæœ¬é€»è¾‘
    print("âœ… å¡å¯†éªŒè¯æˆåŠŸï¼Œå¼€å§‹æ‰§è¡Œè„šæœ¬...")
    # -------------------------- ä½ çš„æ ¸å¿ƒè„šæœ¬é€»è¾‘ --------------------------
    # æ›¿æ¢æˆä½ è‡ªå·±çš„è„šæœ¬åŠŸèƒ½
    print("ğŸ‰ æ ¸å¿ƒè„šæœ¬é€»è¾‘æ‰§è¡Œä¸­...")
    # ç¤ºä¾‹ï¼šæ‰“å°ä¸€äº›æµ‹è¯•å†…å®¹
    for i in range(3):
        print(f"æ‰§è¡Œæ­¥éª¤ {i+1}/3")
    # ----------------------------------------------------------------------
    print("âœ… è„šæœ¬æ‰§è¡Œå®Œæˆï¼")

if __name__ == "__main__":
    main()
